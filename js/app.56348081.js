(function(e){function t(t){for(var n,i,r=t[0],l=t[1],c=t[2],d=0,m=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(m.length)m.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==o[l]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},o={app:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"191a":function(e,t,a){},"1f2b":function(e,t,a){"use strict";var n=a("191a"),o=a.n(n);o.a},5118:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],i={name:"App"},r=i,l=a("2877"),c=Object(l["a"])(r,o,s,!1,null,null,null),u=c.exports,d=a("8c4f"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("el-form",{ref:"form",staticClass:"form",attrs:{model:e.user,rules:e.rules}},[n("div",{staticClass:"form-login"},[n("img",{staticClass:"logo",attrs:{src:a("e19d")}})]),n("el-form-item",{attrs:{prop:"mobile"}},[n("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),n("el-form-item",{attrs:{prop:"code"}},[n("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}})],1),n("el-form-item",{attrs:{prop:"agree"}},[n("el-checkbox",{model:{value:e.user.agree,callback:function(t){e.$set(e.user,"agree",t)},expression:"user.agree"}},[e._v("我已阅读并同意用户协议和隐私条款")])],1),n("el-form-item",[n("el-button",{staticClass:"form-btn",attrs:{loading:e.loginLoading,type:"primary"},on:{click:function(t){return e.onLogin()}}},[e._v("登录")])],1)],1)],1)},p=[],f=(a("d3b7"),a("bc3a")),g=a.n(f),h=a("d604"),v=a.n(h),b=a("5c96"),_=a.n(b),w=g.a.create({baseURL:"http://ttapi.research.itcast.cn/",transformResponse:[function(e){try{return v.a.parse(e)}catch(t){return e}}]});w.interceptors.request.use((function(e){var t=JSON.parse(window.localStorage.getItem("user"));return t&&(e.headers.Authorization="Bearer ".concat(t.token)),e}),(function(e){return Promise.reject(e)})),w.interceptors.response.use((function(e){return e}),(function(e){return e.response&&401===e.response.status?(window.localStorage.removeItem("user"),lt.push("/login"),b["Message"].error("登录状态无效,请重新登录")):400===e.response.status?b["Message"].error("请求参数错误"):403===e.response.status?Object(b["Message"])({type:"warning",message:"没有操作权限"}):e.response.status>=500&&b["Message"].error("服务端参数异常,请稍后重试"),Promise.reject(e)}));var C=w,y=function(e){return C({method:"POST",url:"/mp/v1_0/authorizations",data:e})},x=function(){return C({method:"GET",url:"/mp/v1_0/user/profile"})},S=function(e){return C({method:"GET",url:"/mp/v1_0/followers",params:e})},$=function(e){return C({method:"PATCH",url:"/mp/v1_0/user/profile",data:e})},k=function(e){return C({method:"PATCH",url:"/mp/v1_0/user/photo",data:e})},I={name:"LoginIndex",components:{},props:{},data:function(){return{user:{mobile:"",code:"",agree:!1},loginLoading:!1,rules:{mobile:[{required:!0,message:"请输入手机号",trigger:"change"},{pattern:/^1[3|5|6|9]\d{9}$/,message:"请输入正确的手机号",trigger:"change"}],code:[{required:!0,message:"请输入验证码",trigger:"change"},{pattern:/^\d{6}$/,message:"请输入正确的验证码",trigger:"change"}],agree:[{validator:function(e,t,a){t?a():a(new Error("请勾选同意"))},trigger:"change"}]}}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onLogin:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.login()}))},login:function(){var e=this;this.loginLoading=!0,y(this.user).then((function(t){console.log(t),e.$message({message:"登录成功",type:"success"}),window.localStorage.setItem("user",JSON.stringify(t.data.data)),e.loginLoading=!1,e.$router.push({name:"home"})})).catch((function(t){console.log(t),e.$message.error("登录失败"),e.loginLoading=!1}))}}},O=I,P=(a("1f2b"),Object(l["a"])(O,m,p,!1,null,"3962f239",null)),z=P.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home-container"},[e._v("首页")])},L=[],j={name:"HomeIndex",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},E=j,U=Object(l["a"])(E,D,L,!1,null,"43ec41f5",null),A=U.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"layout-container"},[a("el-aside",{staticClass:"aside",attrs:{width:"auto"}},[a("app-aside",{staticClass:"aside-item",attrs:{isCollapse:e.isCollapse}})],1),a("el-container",[a("el-header",{staticClass:"header"},[a("div",[a("i",{class:{"el-icon-s-fold":e.isCollapse,"el-icon-s-unfold":!e.isCollapse},on:{click:function(t){e.isCollapse=!e.isCollapse}}}),a("span",[e._v("江苏传智播客教育有限公司")])]),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("img",{staticClass:"image",attrs:{src:e.user.photo}}),e._v(" "+e._s(e.user.name)+" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("设置")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.onLayout()}}},[e._v("退出")])],1)],1)],1),a("el-main",{staticClass:"main"},[a("router-view")],1)],1)],1)},V=[],N=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"aside-container"},[a("el-menu",{staticClass:"aside-item",attrs:{"default-active":e.$route.path,router:"",collapse:e.isCollapse,"background-color":"#002033","text-color":"#fff","active-text-color":"#ffd04b"}},[a("el-menu-item",{attrs:{index:"/"}},[a("i",{staticClass:"el-icon-s-home"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),a("el-menu-item",{attrs:{index:"/article"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("内容管理")])]),a("el-menu-item",{attrs:{index:"/image"}},[a("i",{staticClass:"el-icon-picture-outline\n"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("素材管理")])]),a("el-menu-item",{attrs:{index:"/publish"}},[a("i",{staticClass:"el-icon-s-promotion"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("发布文章")])]),a("el-menu-item",{attrs:{index:"/comment"}},[a("i",{staticClass:"el-icon-chat-dot-square"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("评论管理")])]),a("el-menu-item",{attrs:{index:"/fans"}},[a("i",{staticClass:"el-icon-user"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("粉丝管理")])]),a("el-menu-item",{attrs:{index:"/settings"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("个人设置")])])],1)],1)}),R=[],q={name:"AppAside",components:{},props:["is-collapse"],data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},M=q,B=Object(l["a"])(M,N,R,!1,null,"8ce54c26",null),F=B.exports,G=new n["default"],J={name:"LayoutIndex",components:{AppAside:F},props:{},data:function(){return{user:{},isCollapse:!1}},computed:{},watch:{},created:function(){var e=this;this.LoadUserProfile(),G.$on("update-user",(function(t){e.user.name=t.name,e.user.photo=t.photo}))},mounted:function(){},methods:{LoadUserProfile:function(){var e=this;x().then((function(t){console.log(t),e.user=t.data.data}))},onLayout:function(){var e=this;this.$confirm("确认退出吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.localStorage.removeItem("user"),e.$router.push("/login")})).catch((function(){e.$message({type:"info",message:"已取消退出"})}))}}},H=J,K=(a("5dd3"),Object(l["a"])(H,T,V,!1,null,"475720fe",null)),Q=K.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("内容管理")])],1)],1),a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"40px",size:"mini"}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("el-radio",{attrs:{label:null}},[e._v("全部")]),a("el-radio",{attrs:{label:0}},[e._v("草稿")]),a("el-radio",{attrs:{label:1}},[e._v("待审核")]),a("el-radio",{attrs:{label:2}},[e._v("审核成功")]),a("el-radio",{attrs:{label:3}},[e._v("审核失败")]),a("el-radio",{attrs:{label:4}},[e._v("已删除")])],1)],1),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.channelId,callback:function(t){e.channelId=t},expression:"channelId"}},[a("el-option",{attrs:{label:"全部",value:null}}),e._l(e.channels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],2)],1),a("el-form-item",{attrs:{label:"日期"}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","default-time":["12:00:00"]},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1)]),a("el-form-item",[a("el-button",{attrs:{disabled:e.loading,type:"primary"},on:{click:function(t){return e.loadArticles(1)}}},[e._v("查询")])],1)],1)],1),a("el-card",{staticClass:"box-card card1"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("根据筛选条件共查询到"+e._s(e.totalCount)+"条")])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"list-table",staticStyle:{width:"100%"},attrs:{size:"mini",data:e.articles}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.row.cover.images[0],fit:"fit"}},[a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),a("span",{staticClass:"dot"},[e._v("...")])])])]}}])}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.articleStatus[t.row.status].type}},[e._v(e._s(e.articleStatus[t.row.status].item))])]}}])}),a("el-table-column",{attrs:{prop:"pubdate",label:"发表时间"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-edit",circle:"",type:"primary",size:"mini"},on:{click:function(a){e.$router.push("/publish?id="+t.row.id.toString())}}}),a("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-delete","current-page":e.page,type:"danger"},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},click:function(a){return e.ondeleteArticle(t.row.id)}}})]}}])})],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",disabled:e.loading,"page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.onCurrentChange}})],1)],1)},X=[],Y=(a("25f0"),function(e){return C({method:"GET",url:"/mp/v1_0/articles",params:e})}),Z=function(){return C({method:"GET",url:"/mp/v1_0/channels"})},ee=function(e){return C({method:"DELETE",url:"/mp/v1_0/articles/".concat(e)})},te=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C({method:"POST",url:"/mp/v1_0/articles",params:{draft:t},data:e})},ae=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return C({method:"PUT",url:"/mp/v1_0/articles/".concat(e),params:{draft:a},data:t})},ne=function(e){return C({method:"GET",url:"/mp/v1_0/articles/".concat(e)})},oe=function(e,t){return C({method:"PUT",url:"/mp/v1_0/comments/status",params:{article_id:e},data:{allow_comment:t}})},se={name:"ArticleIndex",components:{},props:{},data:function(){return{form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},articles:[],articleStatus:[{status:0,item:"草稿",type:""},{status:1,item:"待审核",type:"info"},{status:2,item:"审核通过",type:"success"},{status:3,item:"审核失败",type:"danger"},{status:4,item:"已删除",type:"warning"}],pageSize:20,totalCount:0,status:null,loading:!0,channels:[],channelId:null,rangeDate:null,page:1}},computed:{},watch:{},created:function(){this.loadArticles(1),this.loadChannels()},mounted:function(){},methods:{loadArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,Y({page:t,per_page:this.pageSize,status:this.status,channel_id:this.channelId,begin_pubdate:this.rangeDate?this.rangeDate[0]:null,end_pubdate:this.rangeDate?this.rangeDate[1]:null}).then((function(t){console.log(t);var a=t.data.data,n=a.results,o=a.total_count;e.articles=n,e.totalCount=o,e.loading=!1}))},onCurrentChange:function(e){this.loadArticles(e)},loadChannels:function(){var e=this;Z().then((function(t){console.log(t),e.channels=t.data.data.channels}))},ondeleteArticle:function(e){var t=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ee(e.toString()).then((function(e){t.loadArticles(t.page),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}))}}},ie=se,re=(a("efe3"),Object(l["a"])(ie,W,X,!1,null,"02a9d882",null)),le=re.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"publish-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.id?"编辑文章":"发布文章"))])],1)],1),a("el-form",{ref:"form",attrs:{model:e.article,"label-width":"60px",rules:e.formRules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.article.title,callback:function(t){e.$set(e.article,"title",t)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("el-tiptap",{attrs:{extensions:e.extensions,placeholder:"请输入文章内容"},model:{value:e.article.content,callback:function(t){e.$set(e.article,"content",t)},expression:"article.content"}})],1),a("el-form-item",{attrs:{label:"封面",prop:"cover"}},[a("el-radio-group",{model:{value:e.article.cover.type,callback:function(t){e.$set(e.article.cover,"type",t)},expression:"article.cover.type"}},[a("el-radio",{attrs:{label:1}},[e._v("单图")]),a("el-radio",{attrs:{label:3}},[e._v("三图")]),a("el-radio",{attrs:{label:0}},[e._v("无图")]),a("el-radio",{attrs:{label:-1}},[e._v("自定义")])],1),e.article.cover.type>0?e._l(e.article.cover.type,(function(t,n){return a("upload-cover",{key:n,model:{value:e.article.cover.images[n],callback:function(t){e.$set(e.article.cover.images,n,t)},expression:"article.cover.images[index]"}})})):e._e()],2),a("el-form-item",{attrs:{label:"频道",prop:"channel_id"}},[a("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.article.channel_id,callback:function(t){e.$set(e.article,"channel_id",t)},expression:"article.channel_id"}},e._l(e.channels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onPublish(!1)}}},[e._v("发布")]),a("el-button",{on:{click:function(t){return e.onPublish(!0)}}},[e._v("存为草稿")])],1)],1)],1)],1)},ue=[],de=function(e){return C({method:"POST",url:"/mp/v1_0/user/images",data:e})},me=function(e){return C({method:"GET",url:"/mp/v1_0/user/images",params:e})},pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C({method:"PUT",url:"/mp/v1_0/user/images/".concat(e),data:{collect:t}})},fe=function(e){return C({method:"DELETE",url:"/mp/v1_0/user/images/".concat(e)})},ge=(a("7eef"),a("4ccc")),he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-cover"},[a("div",{staticClass:"cover-image",on:{click:e.isShowDialog}},[a("img",{ref:"upload-image",staticClass:"coverImage",attrs:{src:e.value,alt:""}})]),a("el-dialog",{attrs:{title:"上传素材",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"素材库",name:"first"}},[a("cover-image",{ref:"cover-image",staticStyle:{width:"100%"},attrs:{"is-show-add":!1,"is-show-action":!1,"is-show-select":""}})],1),a("el-tab-pane",{staticClass:"preview-image-wrap",attrs:{label:"上传图片",name:"second"}},[a("input",{ref:"file",attrs:{type:"file"},on:{change:e.onChangeImage}}),a("img",{staticClass:"preview-image",attrs:{src:e.previewImage}})])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onUploadImage}},[e._v("确 定")])],1)],1)],1)},ve=[],be=(a("3ca3"),a("ddb0"),a("2b3d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cover-image"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(t){return e.onCollectImages(1)}},model:{value:e.collect,callback:function(t){e.collect=t},expression:"collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),e.isShowAdd?a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(t){e.dialogUploadVisible=!0}}},[e._v("上传素材")]):e._e()],1),a("el-row",{attrs:{gutter:10}},e._l(e.image,(function(t,n){return a("el-col",{key:n,attrs:{xs:12,sm:6,md:6,lg:4}},[a("div",{staticClass:"img-list"},[a("el-image",{staticStyle:{height:"100px"},attrs:{src:t.url,fit:"fit"},nativeOn:{click:function(t){e.select=n}}}),e.isShowAction?a("div",{staticClass:"mask"},[a("el-button",{class:{"el-icon-star-on":t.is_collected,"el-icon-star-off":!t.is_collected},attrs:{type:"warning",circle:"",size:"mini",loading:t.loading},on:{click:function(a){return e.onChangeCollected(t)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",loading:t.loading},on:{click:function(a){return e.onDeleteImage(t)}}})],1):e._e(),e.isShowSelect&&e.select===n?a("div",{staticClass:"select"}):e._e()],1)])})),1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"page-size":e.pageSize,"current-page":e.currentPage,background:"",layout:"prev, pager, next",total:e.totalCount},on:{"current-change":e.loadImages}}),a("el-dialog",{attrs:{title:"上传素材",visible:e.dialogUploadVisible,"append-to-body":!0,width:"26.5%"},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",name:"image",action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",headers:e.UploadHeaders,"show-file-list":!0,"on-success":e.uploadSuccessImage,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1)}),_e=[],we=(a("4160"),a("159b"),{name:"CoverImage",components:{},props:{isShowAdd:{type:Boolean,default:!0},isShowAction:{type:Boolean,default:!0},isShowSelect:{type:Boolean,default:!1}},data:function(){var e=JSON.parse(window.localStorage.getItem("user"));return{collect:!1,image:[],currentPage:1,pageSize:10,totalCount:0,dialogUploadVisible:!1,UploadHeaders:{Authorization:"Bearer ".concat(e.token)},select:null}},computed:{},watch:{},created:function(){this.loadImages(1)},mounted:function(){},methods:{loadImages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=t,me({collect:this.collect,page:t,per_page:this.pageSize}).then((function(t){var a=t.data.data.results;a.forEach((function(e){e.loading=!1})),e.image=a,e.totalCount=t.data.data.total_count}))},onCollectImages:function(e){this.loadImages(e)},uploadSuccessImage:function(){this.dialogUploadVisible=!1,this.loadImages(this.page),this.$message({type:"success",message:"图片上传成功"})},onChangeCollected:function(e){var t=this;e.loading=!0,pe(e.id,!e.is_collected).then((function(a){e.is_collected=!e.is_collected,e.is_collected?(t.loadImages(),t.$message({type:"success",message:"收藏成功"})):(t.loadImages(),t.$message({type:"success",message:"取消收藏成功"})),e.loading=!1}))},onDeleteImage:function(e){var t=this;e.loading=!0,fe(e.id).then((function(a){t.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loadImages(t.currentPage),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})})),e.loading=!1}))}}}),Ce=we,ye=(a("9c1c"),Object(l["a"])(Ce,be,_e,!1,null,"62ec29e8",null)),xe=ye.exports,Se={name:"UploadCover",components:{coverImage:xe},props:["value"],data:function(){return{dialogVisible:!1,activeName:"first",previewImage:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{isShowDialog:function(){this.dialogVisible=!0},handleClick:function(e,t){console.log(e,t)},onChangeImage:function(){var e=this.$refs.file,t=e.files[0],a=window.URL.createObjectURL(t);this.previewImage=a},onUploadImage:function(){var e=this;if("second"===this.activeName){var t=this.$refs.file.files[0];if(!t)return void this.$message("请选择文件");var a=new FormData;a.append("image",t),de(a).then((function(t){e.dialogVisible=!1,e.$refs["upload-image"].src=t.data.data.url,e.$emit("input",t.data.data.url)}))}else if("first"===this.activeName){var n=this.$refs["cover-image"];console.log(n);var o=n.select;if(null===o)return void this.$message("请选择图片");this.dialogVisible=!1,this.$emit("input",n.image[o].url)}}}},$e=Se,ke=(a("d177"),Object(l["a"])($e,he,ve,!1,null,"51e8bdee",null)),Ie=ke.exports,Oe={name:"PublishIndex",components:{"el-tiptap":ge["e"],UploadCover:Ie},props:{},data:function(){return{article:{title:"",content:"",cover:{type:1,images:[]},channel_id:null},channels:[],extensions:[new ge["d"],new ge["o"],new ge["l"],new ge["g"]({level:5}),new ge["a"]({bubble:!0}),new ge["p"],new ge["i"],new ge["n"],new ge["h"]({uploadRequest:function(e){var t=new FormData;return t.append("image",e),de(t).then((function(e){return e.data.data.url}))}}),new ge["j"],new ge["b"],new ge["k"],new ge["c"],new ge["f"],new ge["m"]],formRules:{title:[{required:!0,message:"请输入文章标题",tigger:"blur"},{min:5,max:30,message:"请输入字数大于5小于30的文章标题",tigger:"blur"}],content:[{validator:function(e,t,a){"<p></p>"===t&&a(new Error("请输入文章内容")),a()}},{required:!0,message:"请输入文章的内容",tigger:"blur"}],channel_id:[{required:!0,message:"请选择频道"}]}}},methods:{loadChannels:function(){var e=this;Z().then((function(t){e.channels=t.data.data.channels}))},onPublish:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.form.validate((function(a){if(a){var n=e.$route.query.id;n?ae(n,e.article,t).then((function(t){e.$message({type:"success",message:"修改成功"}),e.$router.push("/article")})):te(e.article,t).then((function(a){console.log(a),e.$message({type:"success",message:"".concat(t?"存为草稿":"发布成功")}),e.$router.push("/article")}))}}))},getAticle:function(){var e=this;ne(this.$route.query.id).then((function(t){e.article=t.data.data}))}},computed:{},watch:{},created:function(){this.loadChannels(),this.getAticle()},mounted:function(){}},Pe=Oe,ze=Object(l["a"])(Pe,ce,ue,!1,null,"5205a547",null),De=ze.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-container"},[a("el-card",{staticClass:"filter-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("内容管理")]),a("el-breadcrumb-item",[e._v("素材管理")])],1)],1),a("cover-image")],1)],1)},je=[],Ee={name:"ImageIndex",components:{coverImage:xe},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},Ue=Ee,Ae=Object(l["a"])(Ue,Le,je,!1,null,"27354246",null),Te=Ae.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comment-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("评论管理")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.comments,stripe:""}},[a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"total_comment_count",label:"总评论数"}}),a("el-table-column",{attrs:{prop:"fans_comment_count",label:"粉丝评论数"}}),a("el-table-column",{attrs:{prop:"comment_status",label:"评论状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.comment_status?"正常":"关闭")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:e.onDisabledStatus,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.onChangeStatus(t.row)}},model:{value:t.row.comment_status,callback:function(a){e.$set(t.row,"comment_status",a)},expression:"scope.row.comment_status"}})]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,100],"page-size":e.pageSize,disabled:e.onDisabledChange,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},Ne=[],Re={name:"CommentIndex",components:{},props:{},data:function(){return{comments:[],onDisabledStatus:!1,currentPage:1,pageSize:20,totalCount:0,onDisabledChange:!1}},computed:{},watch:{},created:function(){this.loadComments(1)},mounted:function(){},methods:{loadComments:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.onDisabledChange=!0,this.currentPage=t,Y({response_type:"comment",page:t,per_page:this.pageSize}).then((function(t){console.log(t),e.comments=t.data.data.results,e.totalCount=t.data.data.total_count,e.onDisabledChange=!1}))},onChangeStatus:function(e){var t=this;this.onDisabledStatus=!0,oe(e.id.toString(),e.comment_status).then((function(a){t.$message({type:"success",message:e.comment_status?"开启文章评论状态":"关闭文章评论状态"}),t.onDisabledStatus=!1}))},handleSizeChange:function(e){this.loadComments(e)},handleCurrentChange:function(e){this.loadComments(e)}}},qe=Re,Me=Object(l["a"])(qe,Ve,Ne,!1,null,"2eeb68ab",null),Be=Me.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fans-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("粉丝管理")])],1)],1),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"粉丝列表",name:"first"}},[a("el-row",{attrs:{gutter:10}},e._l(e.fansList,(function(t,n){return a("el-col",{key:n,attrs:{lg:3,md:5,sm:6,xs:8}},[a("div",{staticClass:"list"},[a("img",{attrs:{src:t.photo,alt:""}}),a("p",[e._v(e._s(t.name))])])])})),1),a("el-pagination",{staticStyle:{margin:"20px 0 0 -10px"},attrs:{background:"",layout:"prev, pager, next",disabled:e.getDisabled,"page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.loadFansList}})],1),a("el-tab-pane",{attrs:{label:"粉丝头像",name:"second"}},[a("div",{ref:"main",staticStyle:{width:"600px",height:"400px"}})])],1)],1)],1)},Ge=[],Je=a("313e"),He=a.n(Je),Ke={name:"FansIndex",components:{},props:{},data:function(){return{activeName:"first",fansList:[],getDisabled:!1,pageSize:20,totalCount:0}},computed:{},watch:{},created:function(){this.loadFansList()},mounted:function(){var e=He.a.init(this.$refs.main),t={title:{text:"ECharts 入门示例"},tooltip:{},legend:{data:["销量"]},xAxis:{data:["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]},yAxis:{},series:[{name:"销量",type:"bar",data:[5,20,36,10,10,20]}]};e.setOption(t)},methods:{handleClick:function(e,t){console.log(e,t)},loadFansList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.getDisabled=!0,S({page:t,per_page:this.pageSize}).then((function(t){console.log(t),e.fansList=t.data.data.results,e.totalCount=t.data.data.total_count,e.getDisabled=!1}))}}},Qe=Ke,We=(a("b830"),Object(l["a"])(Qe,Fe,Ge,!1,null,"ee23970a",null)),Xe=We.exports,Ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settings-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("个人设置")])],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:20,sm:16,md:16,lg:14}},[a("el-form",{ref:"user-form",attrs:{model:e.user,"label-width":"80px",rules:e.userRules}},[a("el-form-item",{attrs:{label:"编号"}},[e._v(" "+e._s(e.user.id)+" ")]),a("el-form-item",{attrs:{label:"手机"}},[e._v(" "+e._s(e.user.mobile)+" ")]),a("el-form-item",{attrs:{label:"媒体名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请填写媒体名称"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),a("el-form-item",{attrs:{label:"媒体介绍",prop:"intro"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请填写媒体介绍"},model:{value:e.user.intro,callback:function(t){e.$set(e.user,"intro",t)},expression:"user.intro"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请填写邮箱"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmitSettings}},[e._v("保存设置")])],1)],1)],1),a("el-col",{attrs:{xs:4,sm:8,md:8,lg:10}},[a("label",{staticClass:"head-file",attrs:{for:"file"}},[a("el-image",{staticClass:"head",attrs:{src:e.user.photo,fit:"fit"}}),a("p",[e._v("点击更换头像")])],1),a("input",{ref:"file",attrs:{type:"file",id:"file",hidden:""},on:{change:e.onFileChange}})])],1)],1),a("el-dialog",{attrs:{title:"修改头像",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.onDialogOpened,closed:e.onDialogClosed}},[a("div",{staticClass:"preview-image-wrap"},[a("img",{ref:"preview-image",staticClass:"preview-image",attrs:{src:e.previewImage}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.onPhotoLoading},on:{click:e.onUpdatePhoto}},[e._v("确 定")])],1)])],1)},Ze=[],et=(a("ac1f"),a("5319"),a("6107"),a("bab4")),tt=a.n(et),at={name:"SettingsIndex",components:{},props:{},data:function(){return{user:{id:null,mobile:"",name:"",intro:"",email:""},userRules:{name:[{required:!0,message:"请填写媒体名称",tigger:"blur"},{min:1,max:7,message:"请填写1到7个字之间的媒体名称",tigger:"blur"}],intro:[{required:!0,message:"请填写媒体介绍",tigger:"blur"},{validator:function(e,t,a){t||a(new Error("请填写媒体名称")),a()}}],email:[{required:!0,message:"请输入邮箱",tigger:"blur"},{pattern:/^\w+@\w+(\.\w+)+$/,message:"请输入正确的邮箱",tigger:"blur"}]},loading:!1,dialogVisible:!1,previewImage:"",cropper:null,onPhotoLoading:!1}},computed:{},watch:{},created:function(){this.loadUserProfile()},mounted:function(){},methods:{loadUserProfile:function(){var e=this;x().then((function(t){e.user=t.data.data}))},onSubmitSettings:function(){var e=this;this.loading=!0,this.$refs["user-form"].validate((function(t){if(!t)return e.$message("表单验证失败");$(e.user).then((function(t){e.$message({type:"success",message:"保存设置成功"}),e.loading=!1,G.$emit("update-user",e.user)})).catch((function(){e.$message({type:"danger",message:"保存设置失败"}),e.loading=!1}))}))},onFileChange:function(){var e=this;k().then((function(t){var a=e.$refs.file,n=window.URL.createObjectURL(a.files[0]);e.previewImage=n,e.dialogVisible=!0,e.$refs.file.value=""}))},onDialogOpened:function(){var e=this.$refs["preview-image"];this.cropper?this.cropper.replace(this.previewImage):this.cropper=new tt.a(e,{aspectRatio:1,viewMode:1,dragMode:"none",cropBoxResizable:!1})},onDialogClosed:function(){},onUpdatePhoto:function(){var e=this;this.onPhotoLoading=!0,this.cropper.getCroppedCanvas().toBlob((function(t){var a=new FormData;a.append("photo",t),k(a).then((function(a){e.dialogVisible=!1,e.user.photo=window.URL.createObjectURL(t),e.$message({type:"success",message:"更换头像成功"}),e.onPhotoLoading=!1,G.$emit("update-user",e.user)}))}))}}},nt=at,ot=(a("a8c3"),Object(l["a"])(nt,Ye,Ze,!1,null,"36baf1a0",null)),st=ot.exports;n["default"].use(d["a"]);var it=[{path:"/login",name:"login",component:z},{path:"/",component:Q,children:[{path:"",name:"home",component:A},{path:"/article",name:"article",component:le},{path:"/publish",name:"publish",component:De},{path:"/image",name:"image",component:Te},{path:"/comment",name:"comment",component:Be},{path:"/fans",name:"fans",component:Xe},{path:"/settings",name:"settings",component:st}]}],rt=new d["a"]({routes:it});rt.beforeEach((function(e,t,a){var n=JSON.parse(window.localStorage.getItem("user"));"/login"!==e.path?n?a():a("/login"):a()}));var lt=rt;a("cd22"),a("0fae");n["default"].use(_.a),n["default"].config.productionTip=!1,new n["default"]({router:lt,render:function(e){return e(u)}}).$mount("#app")},"5dd3":function(e,t,a){"use strict";var n=a("933e"),o=a.n(n);o.a},"933e":function(e,t,a){},"9c1c":function(e,t,a){"use strict";var n=a("cbed"),o=a.n(n);o.a},"9eeb":function(e,t,a){},a8c3:function(e,t,a){"use strict";var n=a("9eeb"),o=a.n(n);o.a},b830:function(e,t,a){"use strict";var n=a("5118"),o=a.n(n);o.a},cbed:function(e,t,a){},cd22:function(e,t,a){},d005:function(e,t,a){},d177:function(e,t,a){"use strict";var n=a("d005"),o=a.n(n);o.a},d6fa:function(e,t,a){},e19d:function(e,t,a){e.exports=a.p+"img/logo_index.e0892259.png"},efe3:function(e,t,a){"use strict";var n=a("d6fa"),o=a.n(n);o.a}});
//# sourceMappingURL=app.56348081.js.map